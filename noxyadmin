-- NOXY AND VANTRIX ADMIN PANEL - DIRECT ACCESS
-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Admin Panel Functions
local selectedPlayer = nil

-- Command Functions
local function rocketPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyVelocity.Velocity = Vector3.new(math.random(-20, 20), 150, math.random(-20, 20))
        bodyVelocity.Parent = targetPlayer.Character.HumanoidRootPart
        
        local fire = Instance.new("Fire")
        fire.Size = 10
        fire.Heat = 15
        fire.Parent = targetPlayer.Character.HumanoidRootPart
        
        game:GetService("Debris"):AddItem(bodyVelocity, 4)
        game:GetService("Debris"):AddItem(fire, 4)
    end
end

local function ragdollPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
        local humanoid = targetPlayer.Character.Humanoid
        humanoid.PlatformStand = true
        humanoid.Sit = true
        
        for _, part in pairs(targetPlayer.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
                bodyVelocity.Velocity = Vector3.new(math.random(-50, 50), math.random(-50, 50), math.random(-50, 50))
                bodyVelocity.Parent = part
                game:GetService("Debris"):AddItem(bodyVelocity, 0.5)
            end
        end
        
        wait(8)
        if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
            humanoid.PlatformStand = false
            humanoid.Sit = false
        end
    end
end

local function balloonPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Head") then
        local balloon = Instance.new("Part")
        balloon.Name = "Balloon"
        balloon.Size = Vector3.new(6, 6, 6)
        balloon.Shape = Enum.PartType.Ball
        balloon.Material = Enum.Material.Neon
        balloon.Color = Color3.new(1, 1, 1)
        balloon.CanCollide = false
        balloon.Parent = targetPlayer.Character
        
        local weld = Instance.new("WeldConstraint")
        weld.Part0 = balloon
        weld.Part1 = targetPlayer.Character.Head
        weld.Parent = balloon
        
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyVelocity.Velocity = Vector3.new(0, 25, 0)
        bodyVelocity.Parent = targetPlayer.Character.HumanoidRootPart
        
        game:GetService("Debris"):AddItem(balloon, 15)
        game:GetService("Debris"):AddItem(bodyVelocity, 15)
    end
end

local function inversePlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
        local humanoid = targetPlayer.Character.Humanoid
        
        local connection
        connection = RunService.Heartbeat:Connect(function()
            if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local moveVector = humanoid.MoveDirection
                if moveVector.Magnitude > 0 then
                    local rootPart = targetPlayer.Character.HumanoidRootPart
                    rootPart.Velocity = Vector3.new(-moveVector.X * 20, rootPart.Velocity.Y, -moveVector.Z * 20)
                end
            else
                connection:Disconnect()
            end
        end)
        
        wait(10)
        if connection then
            connection:Disconnect()
        end
    end
end

local function nightvisionPlayer(targetPlayer)
    if targetPlayer == player then
        local lighting = game:GetService("Lighting")
        lighting.Brightness = 3
        lighting.Ambient = Color3.new(0.8, 0.8, 1)
        
        wait(60)
        lighting.Brightness = 1
        lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
    end
end

local function jailPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local jailModel = Instance.new("Model")
        jailModel.Name = "Jail"
        jailModel.Parent = workspace
        
        local center = targetPlayer.Character.HumanoidRootPart.Position
        
        for i = 1, 8 do
            local bar = Instance.new("Part")
            bar.Size = Vector3.new(1, 10, 1)
            bar.Material = Enum.Material.Metal
            bar.Color = Color3.new(0.2, 0.2, 0.2)
            bar.CanCollide = true
            bar.Anchored = true
            
            local angle = (i - 1) * (math.pi * 2 / 8)
            bar.Position = center + Vector3.new(math.cos(angle) * 4, 0, math.sin(angle) * 4)
            bar.Parent = jailModel
        end
        
        targetPlayer.Character.HumanoidRootPart.Anchored = true
        
        wait(10)
        if jailModel then jailModel:Destroy() end
        if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            targetPlayer.Character.HumanoidRootPart.Anchored = false
        end
    end
end

local function controlPlayer(targetPlayer)
    if targetPlayer and targetPlayer ~= player and targetPlayer.Character then
        local gui = Instance.new("BillboardGui")
        gui.Size = UDim2.new(0, 100, 0, 50)
        gui.Parent = targetPlayer.Character.Head
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = "CONTROLLED"
        label.TextColor3 = Color3.new(1, 0, 0)
        label.TextScaled = true
        label.Font = Enum.Font.GothamBold
        label.Parent = gui
        
        wait(10)
        if gui then gui:Destroy() end
    end
end

local function tinyPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
        local humanoid = targetPlayer.Character.Humanoid
        
        for _, part in pairs(targetPlayer.Character:GetChildren()) do
            if part:IsA("BasePart") then
                part.Size = part.Size * 0.1
            end
        end
        
        wait(30)
        
        if targetPlayer.Character then
            for _, part in pairs(targetPlayer.Character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Size = part.Size * 10
                end
            end
        end
    end
end

local function jumpscarePlayer(targetPlayer)
    if targetPlayer == player then
        local jumpscareGui = Instance.new("ScreenGui")
        jumpscareGui.Name = "BrainrotJumpscare"
        jumpscareGui.Parent = playerGui
        
        local jumpscareFrame = Instance.new("Frame")
        jumpscareFrame.Size = UDim2.new(1, 0, 1, 0)
        jumpscareFrame.Position = UDim2.new(0, 0, 0, 0)
        jumpscareFrame.BackgroundColor3 = Color3.new(0, 0, 0)
        jumpscareFrame.Parent = jumpscareGui
        
        local jumpscareText = Instance.new("TextLabel")
        jumpscareText.Size = UDim2.new(1, 0, 1, 0)
        jumpscareText.BackgroundTransparency = 1
        jumpscareText.Text = "BRAINROT JUMPSCARE!"
        jumpscareText.TextColor3 = Color3.new(1, 0, 0)
        jumpscareText.TextScaled = true
        jumpscareText.Font = Enum.Font.GothamBold
        jumpscareText.Parent = jumpscareFrame
        
        for i = 1, 5 do
            jumpscareFrame.BackgroundColor3 = Color3.new(1, 0, 0)
            wait(0.1)
            jumpscareFrame.BackgroundColor3 = Color3.new(0, 0, 0)
            wait(0.1)
        end
        
        wait(1)
        jumpscareGui:Destroy()
    end
end

local function morphPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character then
        for _, part in pairs(targetPlayer.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Color = Color3.new(math.random(), math.random(), math.random())
                part.Material = Enum.Material.Neon
            end
        end
        
        wait(30)
        
        if targetPlayer.Character then
            for _, part in pairs(targetPlayer.Character:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.Color = Color3.new(0.7, 0.7, 0.7)
                    part.Material = Enum.Material.Plastic
                end
            end
        end
    end
end

-- Create Admin Panel (Direct - No Key System)
local function createAdminPanel()
    local adminGui = Instance.new("ScreenGui")
    adminGui.Name = "NoxyAdminPanel"
    adminGui.ResetOnSpawn = false
    adminGui.Parent = playerGui

    -- Main Frame - Exact style from image
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 600, 0, 400)
    mainFrame.Position = UDim2.new(0.5, -300, 0.5, -200)
    mainFrame.BackgroundColor3 = Color3.new(0.3, 0.4, 0.5)
    mainFrame.BorderSizePixel = 3
    mainFrame.BorderColor3 = Color3.new(1, 0, 0)
    mainFrame.Parent = adminGui

    -- Title exactly like image
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -50, 0, 50)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "ADMIN PANEL"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.TextScaled = true
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = mainFrame

    -- Close Button (X) exactly like image
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 40, 0, 40)
    closeBtn.Position = UDim2.new(1, -45, 0, 5)
    closeBtn.BackgroundColor3 = Color3.new(0.8, 0, 0)
    closeBtn.BorderSizePixel = 0
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.new(1, 1, 1)
    closeBtn.TextScaled = true
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Parent = mainFrame

    closeBtn.MouseButton1Click:Connect(function()
        adminGui:Destroy()
    end)

    -- Command Input Section exactly like image
    local commandFrame = Instance.new("Frame")
    commandFrame.Size = UDim2.new(0.58, 0, 0, 80)
    commandFrame.Position = UDim2.new(0.02, 0, 0.15, 0)
    commandFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    commandFrame.BorderColor3 = Color3.new(1, 0, 0)
    commandFrame.BorderSizePixel = 2
    commandFrame.Parent = mainFrame

    local commandLabel = Instance.new("TextLabel")
    commandLabel.Size = UDim2.new(1, 0, 0, 25)
    commandLabel.Position = UDim2.new(0, 5, 0, 5)
    commandLabel.BackgroundTransparency = 1
    commandLabel.Text = "Type Command"
    commandLabel.TextColor3 = Color3.new(1, 1, 1)
    commandLabel.TextScaled = true
    commandLabel.Font = Enum.Font.Gotham
    commandLabel.TextXAlignment = Enum.TextXAlignment.Left
    commandLabel.Parent = commandFrame

    local commandBox = Instance.new("TextBox")
    commandBox.Size = UDim2.new(1, -10, 0, 40)
    commandBox.Position = UDim2.new(0, 5, 0, 30)
    commandBox.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
    commandBox.BorderSizePixel = 0
    commandBox.Text = ""
    commandBox.PlaceholderText = "Enter command"
    commandBox.TextColor3 = Color3.new(0.7, 0.7, 0.7)
    commandBox.PlaceholderColor3 = Color3.new(0.5, 0.5, 0.5)
    commandBox.TextScaled = true
    commandBox.Font = Enum.Font.Gotham
    commandBox.Parent = commandFrame

    -- Command Buttons Grid exactly like image
    local commands = {
        {name = "rocket", icon = "üöÄ", func = rocketPlayer},
        {name = "ragdoll", icon = "ü§∏", func = ragdollPlayer},
        {name = "balloon", icon = "üéà", func = balloonPlayer},
        {name = "inverse", icon = "üîÑ", func = inversePlayer},
        {name = "nightvision", icon = "üëÅ", func = nightvisionPlayer},
        {name = "jail", icon = "üîí", func = jailPlayer},
        {name = "control", icon = "üéÆ", func = controlPlayer},
        {name = "tiny", icon = "üêú", func = tinyPlayer},
        {name = "jumpscare", icon = "üëª", func = jumpscarePlayer},
        {name = "morph", icon = "üß†", func = morphPlayer}
    }

    for i, cmd in pairs(commands) do
        local row = math.floor((i - 1) / 2)
        local col = (i - 1) % 2
        
        local cmdBtn = Instance.new("TextButton")
        cmdBtn.Size = UDim2.new(0.28, 0, 0, 50)
        cmdBtn.Position = UDim2.new(0.02 + col * 0.3, 0, 0.4 + row * 0.11, 0)
        cmdBtn.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
        cmdBtn.BorderColor3 = Color3.new(0.8, 0.8, 0)
        cmdBtn.BorderSizePixel = 2
        cmdBtn.Text = cmd.icon .. " ;" .. cmd.name
        cmdBtn.TextColor3 = Color3.new(1, 1, 1)
        cmdBtn.TextScaled = true
        cmdBtn.Font = Enum.Font.Gotham
        cmdBtn.Parent = mainFrame

        cmdBtn.MouseButton1Click:Connect(function()
            if selectedPlayer then
                cmd.func(selectedPlayer)
            end
        end)
    end

    -- Player List exactly like image
    local playerListFrame = Instance.new("Frame")
    playerListFrame.Size = UDim2.new(0.38, 0, 0.82, 0)
    playerListFrame.Position = UDim2.new(0.6, 0, 0.15, 0)
    playerListFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    playerListFrame.BorderColor3 = Color3.new(1, 0, 0)
    playerListFrame.BorderSizePixel = 2
    playerListFrame.Parent = mainFrame

    local playerListScroll = Instance.new("ScrollingFrame")
    playerListScroll.Size = UDim2.new(1, -10, 1, -10)
    playerListScroll.Position = UDim2.new(0, 5, 0, 5)
    playerListScroll.BackgroundTransparency = 1
    playerListScroll.ScrollBarThickness = 8
    playerListScroll.Parent = playerListFrame

    -- Update Player List
    local function updatePlayerList()
        for _, child in pairs(playerListScroll:GetChildren()) do
            if child:IsA("TextButton") then
                child:Destroy()
            end
        end

        local yPos = 0
        for _, p in pairs(Players:GetPlayers()) do
            local playerBtn = Instance.new("TextButton")
            playerBtn.Size = UDim2.new(1, -15, 0, 35)
            playerBtn.Position = UDim2.new(0, 5, 0, yPos)
            playerBtn.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
            playerBtn.BorderSizePixel = 0
            playerBtn.Text = p.Name
            playerBtn.TextColor3 = Color3.new(1, 1, 1)
            playerBtn.TextScaled = true
            playerBtn.Font = Enum.Font.Gotham
            playerBtn.Parent = playerListScroll

            playerBtn.MouseButton1Click:Connect(function()
                selectedPlayer = p
                for _, btn in pairs(playerListScroll:GetChildren()) do
                    if btn:IsA("TextButton") then
                        btn.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
                    end
                end
                playerBtn.BackgroundColor3 = Color3.new(0, 0.5, 0)
            end)

            yPos = yPos + 40
        end
        
        playerListScroll.CanvasSize = UDim2.new(0, 0, 0, yPos)
    end

    -- Command Processing
    commandBox.FocusLost:Connect(function(enterPressed)
        if enterPressed and selectedPlayer then
            local command = string.lower(commandBox.Text)
            commandBox.Text = ""
            
            for _, cmd in pairs(commands) do
                if command:find(";" .. cmd.name) then
                    cmd.func(selectedPlayer)
                    break
                end
            end
        end
    end)

    -- Initial setup
    updatePlayerList()
    Players.PlayerAdded:Connect(updatePlayerList)
    Players.PlayerRemoving:Connect(updatePlayerList)

    -- Make draggable
    local dragging = false
    local dragStart = nil
    local startPos = nil

    title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
end

-- Start directly without key system
createAdminPanel()
